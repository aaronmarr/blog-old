<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Deploying Eleventy to Github Pages using Travis CI</title>
    <meta name="Description" content="Taking a look at deploying an 11ty site to Github Pages Travis CI">
    <link rel="stylesheet" href="https://necolas.github.io/normalize.css/8.0.1/normalize.css">
    <link type="text/css" rel="stylesheet" href="/build/index.css?v=13">
    <link rel="stylesheet" href="/build/prism-base16-monokai.dark.css?v=13">
    <link rel="alternate" href="/feed/feed.xml" type="application/atom+xml" title="Aaron Marr">
    <!-- <link rel="stylesheet" href="//basehold.it/8">     -->
  </head>
  <body class="line-numbers dark">
    

    <header class="header">
      <div class="header__content">
        <h1 class="site-name">
          <a class="site-name__link" href="/posts/eleventy-travis-ci/">
            Aaron Marr
          </a>
        </h1>
        <nav class="nav">
          <ul class="nav__list"><li class="nav__item">
              <a class="nav__link" href="/posts/">
                Blog
              </a>
            </li><li class="nav__item">
              <a class="nav__link" href="/feed/feed.xml">
                RSS
              </a>
            </li><li class="nav__item">
              <a href="#" class="nav__link" onclick="localStorage.setItem('mode', (localStorage.getItem('mode') || 'dark') === 'dark' ? 'light' : 'dark'); localStorage.getItem('mode') === 'dark' ? document.querySelector('body').classList.add('dark') : document.querySelector('body').classList.remove('dark')" title="Dark/light">
                Light|Dark
              </a>
            </li>
          </ul>
        </nav>
      </div>
    </header>

    <main class="main typeset template-post">
      <h1 class="post-title">Deploying Eleventy to Github Pages using Travis CI</h1>
<time class="post-date" datetime="2019-07-25">25 Jul 2019</time>
<p><a href="https://www.11ty.io">Eleventy</a> is a great tool for building static websites using JavaScript. I've always been a fan of <a href="https://jekyllrb.com">Jekyll</a>, but Eleventy has been my go-to tool recently for static web builds; It's super simple to get started and includes some excellent documentation and starter projects to get you going.</p>
<p>One of the things I wanted to figure out was how to deploy Eleventy to <a href="https://pages.github.com">Github Pages</a>. A few years ago I might have written a Gulp task to build locally and push to a branch on Github, but it's 2019 and we can do better than that! The <a href="https://github.com/11ty/eleventy-base-blog">Eleventy blog</a> starter project includes a helpful set of config files for setting up CI with either Travis or Netlify. In this post, I'll take a look at setting up a deployment pipeline in Travis.</p>
<h2 id="create-a-repository-on-github">Create a repository on Github <a class="hidden" href="#create-a-repository-on-github" aria-hidden="true">#</a></h2>
<p>The first thing you will need is an Eleventy installation pushed to a repository on Github. I used the <a href="https://github.com/11ty/eleventy-base-blog">Eleventy blog</a> starter project for my site, which includes the helpful Travis settings file I mentioned. I called my repository <code>blog</code> and pushed the project code to the <code>master</code> branch.</p>
<p>There are a few settings in Github which I also adjusted. In the repository settings, there's a section for Github Pages. In here, I selected &quot;enable pages&quot; and set up my custom domain name.</p>
<aside>If you're using a custom domain, you'll need to point your DNS to the Github Pages IPs, and also create a CNAME file in the base of your repository. More details about that can be found in the Github documentation.</aside>
<p>One final step you will need to do is create a Github authentication key, which will be used by Travis to authenticate. In the developer menu in Github, set up a new key, and copy to your clipboard. You will use this key once Travis has been set up.</p>
<h2 id="set-up-travis">Set up Travis <a class="hidden" href="#set-up-travis" aria-hidden="true">#</a></h2>
<p>At this point, I signed up for Travis. On signing up, you should follow the on-screen instructions to integrate Travis with your Github account. There will be several steps and you will be asked to grant permissions to Travis so that it can access any repositories you want to build and deploy.</p>
<p>Once the setup process is complete, you should see your project repository in Travis. In the settings, you should add a new authentication key and paste in the key from the previous step. You should call this key <code>$GITHUB_TOKEN</code>.Â If you look inside the <code>travis.yml</code> file in your repo, you'll see there's a property called <code>github-token</code> which matches this key. This is what Travis uses to authenticate with Github when building and deploying.</p>
<p>While inside the <code>travis.yml</code> file, there are a few other settings which should be updated. I set the path prefix to &quot;/&quot;. I also added my custom domain under the <code>fqdn</code> setting and set the build and deploy branches. These are set to <code>master</code> and <code>gh-pages</code>, respectively. Here's what my finalised <code>travis.yml</code> file looks like.</p>
<pre class="language-ruby"><code class="language-ruby"><span class="highlight-line">language<span class="token punctuation">:</span> node_js</span><br><span class="highlight-line">node_js<span class="token punctuation">:</span></span><br><span class="highlight-line">  <span class="token operator">-</span> <span class="token number">8</span></span><br><span class="highlight-line">before_script<span class="token punctuation">:</span></span><br><span class="highlight-line">  <span class="token operator">-</span> npm install @<span class="token number">11</span>ty<span class="token operator">/</span>eleventy <span class="token operator">-</span>g</span><br><span class="highlight-line">script<span class="token punctuation">:</span> eleventy <span class="token operator">--</span>pathprefix<span class="token operator">=</span><span class="token string">"/"</span></span><br><span class="highlight-line">deploy<span class="token punctuation">:</span></span><br><span class="highlight-line">  fqdn<span class="token punctuation">:</span> aaronmarr<span class="token punctuation">.</span>co<span class="token punctuation">.</span>uk</span><br><span class="highlight-line">  local<span class="token operator">-</span>dir<span class="token punctuation">:</span> _site</span><br><span class="highlight-line">  provider<span class="token punctuation">:</span> pages</span><br><span class="highlight-line">  skip<span class="token operator">-</span>cleanup<span class="token punctuation">:</span> <span class="token keyword">true</span></span><br><span class="highlight-line">  github<span class="token operator">-</span>token<span class="token punctuation">:</span> <span class="token variable">$GITHUB_TOKEN</span>  <span class="token comment"># Set in travis-ci.org dashboard, marked secure</span></span><br><span class="highlight-line">  keep<span class="token operator">-</span>history<span class="token punctuation">:</span> <span class="token keyword">true</span></span><br><span class="highlight-line">  target_branch<span class="token punctuation">:</span> gh<span class="token operator">-</span>pages</span><br><span class="highlight-line">  on<span class="token punctuation">:</span></span><br><span class="highlight-line">    branch<span class="token punctuation">:</span> master</span></code></pre>
<p>At this point, you should be able to build and deploy to Github. In Travis, select &quot;Build Now&quot; and wait a minute or two for Travis to do its thing. Once Travis has finished building, you'll see a success message in the console indicating that your site is deployed.</p>
<p>One thing to bear in mind is Travis will conveniently deploy whatever you push to your <code>master</code> branch. For development, I set up a <code>develop</code> branch on Github, so that I only push/merge to <code>master</code> when I want to trigger a deployment.</p>
<p>If you head back over to Github, you should see that Travis has created a new branch, <code>gh-pages</code>, with the built site inside. You should also now be able to see your site live. I hope you've found this post useful, please get in touch if you have any questions or comments. Thanks for reading.</p>




    </main>

    <footer class="footer">
      <div class="footer__content">
        <p>&copy; Aaron Marr 2019.</p>
      </div>
    </footer>

    <div id="redirect" data-redirect-url="/posts/eleventy-travis-ci/"</div>
    <script>
      document.addEventListener('DOMContentLoaded', function(event) {
        ((localStorage.getItem('mode') || 'dark') === 'dark') ? document.querySelector('body').classList.add('dark') : document.querySelector('body').classList.remove('dark')
      })</script>
  </body>
</html>
