<!doctype html>
<html lang="en" class="text-base sm:text-base md:text-lg lg:text-xl">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Using React Context Types</title>
    <meta name="Description" content="Understanding how to use Context Types in React">
    <link type="text/css" rel="stylesheet" href="/build/index.css?v=21">
    <link rel="alternate" href="/feed/feed.xml" type="application/atom+xml" title="Aaron Marr">
  </head>
  <body class="font-serif">
    
    <header class="[ site-header ] [ ]">
      <div class="p-4 max-w-xl m-auto">
        <a href="#content" class="visually-hidden">Skip to main content</a>
        <div class="">
          <div class="lg:flex items-center justify-between flex-wrap bg-teal">
            <div class="flex items-center flex-no-shrink text-white mr-6">
              <a href="/" class="font-sans font-normal text-base tracking-tight">Aaron Marr</a>
            </div>
            <nav class="text-sm ml-auto overflow-x-auto flex font-sans">
              <a 
                href="/posts"
                class="py-2 flex-shrink-0 hover:no-underline ml-0 lg:ml-0 underline"
              >
                Blog
              </a>
              <a 
                href="/assets/aaronmarr_cv.pdf"
                class="py-2 flex-shrink-0 hover:no-underline ml-2 lg:ml-4 underline"
              >
                Download CV
              </a>
              <a 
                href="mailto:hello@aaronmarr.co.uk" 
                class="py-2 flex-shrink-0 hover:no-underline ml-2 lg:ml-4 underline"
              >
                Email Me
              </a>
              <a 
                href="https://twitter.com/_aaronmarr" 
                class="py-2 flex-shrink-0 hover:no-underline ml-2 lg:ml-4 underline"
              >
                Twitter
              </a>
              <a 
                href="https://linkedin.com/in/aaron-marr" 
                class="py-2 flex-shrink-0 hover:no-underline ml-2 lg:ml-4 underline"
              >
                LinkedIn
              </a>
            </nav>
          </div>
        </div>
      </div>
    </header>
    <main id="content">
      <article>
  <header class="pt-8 pb-4">
    <div class="[ banner ] [ py-2 px-4 max-w-xl m-auto ]">
      <h2 class="[ banner__headline ] [ font-bold font-serif leading-tight text-2xl sm:text-2xl md:text-3xl tracking-tight mt-0 mb-2 ]">Using React Context Types</h2>
      <time class="[ banner__strapline ] [ font-sans text-sm ]" datetime="2020-02-02">2nd February 2020</time>
    </div>
  </header>
  <div class="[ typeset template-post ] [ px-4 max-w-xl m-auto ]">
    <p>In a <a href="/posts/getting-started-with-react-context/">previous post</a>, I explored using React Contexts to manage application state. In this post I want to look at taking this approach one step further by using React context-types within the class. This can help reduce the amount of boilerplate within classes that consume React context. Let’s take a look.</p>
<p>This post follows directly from my <a href="/posts/getting-started-with-react-context/">previous post</a> on React context, so please read that first before continuing here.</p>
<blockquote>
<p>Full source code for this tutorial can be <a href="https://github.com/aaronmarr/react-context-type-example">found here</a></p>
</blockquote>
<h2 id="recap">Recap <a class="hidden" href="#recap">#</a></h2>
<p>Let’s just recap what our consumer context looks like.</p>
<pre class="language-js"><code class="language-js"><span class="highlight-line"><span class="token keyword">import</span> React <span class="token keyword">from</span> ‘react’<span class="token punctuation">;</span></span><br><span class="highlight-line"><span class="token keyword">import</span> <span class="token punctuation">{</span> CounterConsumer <span class="token punctuation">}</span> <span class="token keyword">from</span> ‘<span class="token punctuation">.</span><span class="token operator">/</span>CounterContext’<span class="token punctuation">;</span></span><br><span class="highlight-line"></span><br><span class="highlight-line"><span class="token comment">// We have a simple functional component which consumes</span></span><br><span class="highlight-line"><span class="token comment">// the counter context</span></span><br><span class="highlight-line"><span class="token keyword">const</span> <span class="token function-variable function">Counter</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">(</span></span><br><span class="highlight-line">  <span class="token operator">&lt;</span>CounterConsumer<span class="token operator">></span></span><br><span class="highlight-line">	  <span class="token comment">// Render props pattern gives us access to context</span></span><br><span class="highlight-line">    <span class="token punctuation">{</span><span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> counter<span class="token punctuation">,</span> onIncrement<span class="token punctuation">,</span> onDecrement <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">(</span></span><br><span class="highlight-line">      <span class="token operator">&lt;</span>div className<span class="token operator">=</span>“counter”<span class="token operator">></span></span><br><span class="highlight-line">        <span class="token operator">&lt;</span>h1 className<span class="token operator">=</span>“counter__count”<span class="token operator">></span>Count<span class="token operator">:</span> <span class="token punctuation">{</span>counter<span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>h1<span class="token operator">></span></span><br><span class="highlight-line">        <span class="token operator">&lt;</span>button className<span class="token operator">=</span>“counter__inc” onClick<span class="token operator">=</span><span class="token punctuation">{</span>onIncrement<span class="token punctuation">}</span><span class="token operator">></span><span class="token operator">+</span><span class="token operator">&lt;</span><span class="token operator">/</span>button<span class="token operator">></span> </span><br><span class="highlight-line">		  <span class="token operator">&lt;</span>button className<span class="token operator">=</span>“counter__dec” onClick<span class="token operator">=</span><span class="token punctuation">{</span>onDecrement<span class="token punctuation">}</span><span class="token operator">></span><span class="token operator">-</span><span class="token operator">&lt;</span><span class="token operator">/</span>button<span class="token operator">></span> </span><br><span class="highlight-line">      <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">></span></span><br><span class="highlight-line">    <span class="token punctuation">)</span><span class="token punctuation">}</span></span><br><span class="highlight-line">  <span class="token operator">&lt;</span><span class="token operator">/</span>CounterConsumer<span class="token operator">></span></span><br><span class="highlight-line"><span class="token punctuation">)</span><span class="token punctuation">;</span></span><br><span class="highlight-line"></span><br><span class="highlight-line"><span class="token keyword">export</span> <span class="token keyword">default</span> Counter<span class="token punctuation">;</span></span></code></pre>
<p>This works fine, but it does introduce a couple levels of nesting where we introduce the <code>Consumer</code> component and the render props function.</p>
<h2 id="using-contexttype">Using contextType <a class="hidden" href="#using-contexttype">#</a></h2>
<p>Now we’ll take a look at how to clean this up using contextType. Context-type is only available for React classes, so we’ll also need to upgrade the functional component to a React class-based component for this example.</p>
<p>The first thing we’ll need to do (after upgrading the component to a class) is specify the <code>contextType</code>. This static property expects to be given the whole context, rather than just the consumer. We’ll update the import statement, so that we have access to the <code>CounterContext</code> object. We can assign this object to our <code>contextType</code> static prop.</p>
<p>In the render method, we then have access to context via <code>this.context</code>. There’s also no need to wrap the return value in a context component, or use the render-props pattern as we did before. Let’s take a look at what this updated component looks like.</p>
<pre class="language-js"><code class="language-js"><span class="highlight-line"><span class="token keyword">import</span> React <span class="token keyword">from</span> ‘react’<span class="token punctuation">;</span></span><br><span class="highlight-line"><span class="token comment">// Update the import so that we have the full context</span></span><br><span class="highlight-line"><span class="token comment">// object, rather than just the consumer</span></span><br><span class="highlight-line"><span class="token keyword">import</span> <span class="token punctuation">{</span> CounterContext <span class="token punctuation">}</span> <span class="token keyword">from</span> ‘<span class="token punctuation">.</span><span class="token operator">/</span>CounterContext’<span class="token punctuation">;</span></span><br><span class="highlight-line"></span><br><span class="highlight-line"><span class="token keyword">class</span> <span class="token class-name">Counter</span> <span class="token keyword">extends</span> <span class="token class-name">React<span class="token punctuation">.</span>Component</span> <span class="token punctuation">{</span></span><br><span class="highlight-line">  <span class="token comment">// We can specify a context-type for this class which</span></span><br><span class="highlight-line">  <span class="token comment">// will let us consume the context</span></span><br><span class="highlight-line">  <span class="token keyword">static</span> contextType <span class="token operator">=</span> CounterContext<span class="token punctuation">;</span></span><br><span class="highlight-line"></span><br><span class="highlight-line">  <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span><br><span class="highlight-line">    <span class="token comment">// Instead of using the render props pattern, we can</span></span><br><span class="highlight-line">    <span class="token comment">// destructure the this.context object directly.</span></span><br><span class="highlight-line">    <span class="token keyword">const</span> <span class="token punctuation">{</span> counter<span class="token punctuation">,</span> onIncrement<span class="token punctuation">,</span> onDecrement <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>context<span class="token punctuation">;</span></span><br><span class="highlight-line"></span><br><span class="highlight-line">    <span class="token keyword">return</span> <span class="token punctuation">(</span></span><br><span class="highlight-line">      <span class="token comment">// No need to wrap the return value in a context component</span></span><br><span class="highlight-line">      <span class="token operator">&lt;</span>div className<span class="token operator">=</span>“counter”<span class="token operator">></span></span><br><span class="highlight-line">        <span class="token operator">&lt;</span>h1 className<span class="token operator">=</span>“counter__count”<span class="token operator">></span>Count<span class="token operator">:</span> <span class="token punctuation">{</span>counter<span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>h1<span class="token operator">></span></span><br><span class="highlight-line">        <span class="token operator">&lt;</span>button className<span class="token operator">=</span>“counter__inc” onClick<span class="token operator">=</span><span class="token punctuation">{</span>onIncrement<span class="token punctuation">}</span><span class="token operator">></span><span class="token operator">+</span><span class="token operator">&lt;</span><span class="token operator">/</span>button<span class="token operator">></span> </span><br><span class="highlight-line">        <span class="token operator">&lt;</span>button className<span class="token operator">=</span>“counter__dec” onClick<span class="token operator">=</span><span class="token punctuation">{</span>onDecrement<span class="token punctuation">}</span><span class="token operator">></span><span class="token operator">-</span><span class="token operator">&lt;</span><span class="token operator">/</span>button<span class="token operator">></span> </span><br><span class="highlight-line">      <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">></span></span><br><span class="highlight-line">    <span class="token punctuation">)</span></span><br><span class="highlight-line">  <span class="token punctuation">}</span></span><br><span class="highlight-line"><span class="token punctuation">}</span><span class="token punctuation">;</span></span><br><span class="highlight-line"></span><br><span class="highlight-line"><span class="token keyword">export</span> <span class="token keyword">default</span> Counter<span class="token punctuation">;</span></span></code></pre>
<p>I feel like this a much clearer way to structure components that consume context. We did have to upgrade the component to a class-based component for this example – but remember, we’re just trying to illustrate the use of  <code>contextType</code> here. You may wish to leave any functional components as-is and apply this pattern only to class-based components.</p>
<p>You may have noticed that this example doesn’t work in its current state. That’s because we need to update the <code>CounterContext</code> so that it exports the full context object.</p>
<pre class="language-js"><code class="language-js"><span class="highlight-line"><span class="token keyword">import</span> React <span class="token keyword">from</span> ‘react’<span class="token punctuation">;</span></span><br><span class="highlight-line"></span><br><span class="highlight-line"><span class="token comment">// Here we define a new variable for our context </span></span><br><span class="highlight-line"><span class="token keyword">let</span> CounterContext<span class="token punctuation">;</span></span><br><span class="highlight-line"><span class="token comment">// Here we assign the full context object to our new variable</span></span><br><span class="highlight-line"><span class="token keyword">const</span> <span class="token punctuation">{</span> Consumer<span class="token punctuation">,</span> Provider <span class="token punctuation">}</span> <span class="token operator">=</span> CounterContext <span class="token operator">=</span> React<span class="token punctuation">.</span><span class="token function">createContext</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span><br><span class="highlight-line"></span><br><span class="highlight-line"><span class="token operator">...</span></span><br><span class="highlight-line"></span><br><span class="highlight-line"><span class="token comment">// Finally we update the export so that it exports the full </span></span><br><span class="highlight-line"><span class="token comment">// context object, as well as the provider and consumer</span></span><br><span class="highlight-line"><span class="token keyword">export</span> <span class="token punctuation">{</span> CounterProvider<span class="token punctuation">,</span> Consumer <span class="token keyword">as</span> CounterConsumer<span class="token punctuation">,</span> CounterContext <span class="token punctuation">}</span><span class="token punctuation">;</span></span></code></pre>
<p>Now if you run the application, it should all be working.</p>
<p>I hope you’ve found this post useful. Thanks for reading.</p>

  </div>
</article>



    </main>
    <footer class="border-t block pt-4 pb-8 mt-16">
      <div class="max-w-xl m-auto px-4 flex items-baseline">
        <p class="font-sans text-xs">&copy Aaron Marr 2020.</p>
        <a href="#" class="[ site-header__button ] [ ml-auto p-2 border border-solid font-sans text-sm ]" onclick="localStorage.setItem('mode', (localStorage.getItem('mode') || 'dark') === 'dark' ? 'light' : 'dark'); localStorage.getItem('mode') === 'dark' ? document.querySelector('body').classList.add('dark') : document.querySelector('body').classList.remove('dark')" title="Dark/light">
          <span class="hidden-when-dark">Dark mode</span>
          <span class="hidden shown-when-dark">Light mode</span>
        </a>
      </div>
    </footer>
    <script>
        document.addEventListener('DOMContentLoaded', function(event) {
        event.preventDefault();
        ((localStorage.getItem('mode') || 'dark') === 'dark') ?
          document.querySelector('body').classList.add('dark') :
          document.querySelector('body').classList.remove('dark');
      })
    </script>
  </body>
</html>
