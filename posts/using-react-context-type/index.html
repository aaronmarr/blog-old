<!doctype html>
<html lang="en" class="text-base sm:text-base md:text-lg lg:text-xl">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Using React Context Types</title>
    <meta name="Description" content="Understanding how to use Context Types in React">
    <link type="text/css" rel="stylesheet" href="/build/index.css?v=21">
    <link rel="alternate" href="/feed/feed.xml" type="application/atom+xml" title="Aaron Marr">
  </head>
  <body class="font-serif">
    
    <header class="[ site-header ] [ ]">
      <div class="p-4 max-w-xl m-auto">
        <a href="#content" class="visually-hidden">Skip to main content</a>
        <div class="">
          <div class="lg:flex items-center justify-between flex-wrap bg-teal">
            <div class="flex items-center flex-no-shrink text-white mr-6">
              <a href="/" class="font-sans font-normal text-base tracking-tight">Aaron Marr</a>
            </div>
            <nav class="text-sm ml-auto overflow-x-auto flex font-sans">
              <a 
                href="/posts"
                class="py-2 flex-shrink-0 hover:no-underline ml-0 lg:ml-0 underline"
              >
                Blog
              </a>
              <a 
                href="/assets/aaronmarr_cv.pdf"
                class="py-2 flex-shrink-0 hover:no-underline ml-2 lg:ml-4 underline"
              >
                Download CV
              </a>
              <a 
                href="mailto:hello@aaronmarr.co.uk" 
                class="py-2 flex-shrink-0 hover:no-underline ml-2 lg:ml-4 underline"
              >
                Email Me
              </a>
              <a 
                href="https://twitter.com/_aaronmarr" 
                class="py-2 flex-shrink-0 hover:no-underline ml-2 lg:ml-4 underline"
              >
                Twitter
              </a>
              <a 
                href="https://linkedin.com/in/aaron-marr" 
                class="py-2 flex-shrink-0 hover:no-underline ml-2 lg:ml-4 underline"
              >
                LinkedIn
              </a>
            </nav>
          </div>
        </div>
      </div>
    </header>
    <main id="content">
      <article>
  <header class="pt-8 pb-4">
    <div class="[ banner ] [ py-2 px-4 max-w-xl m-auto ]">
      <h2 class="[ banner__headline ] [ font-bold font-serif leading-tight text-2xl sm:text-2xl md:text-3xl tracking-tight mt-0 mb-2 ]">Using React Context Types</h2>
      <time class="[ banner__strapline ] [ font-sans text-sm ]" datetime="2020-02-02">2nd February 2020</time>
    </div>
  </header>
  <div class="[ typeset template-post ] [ px-4 max-w-xl m-auto ]">
    <p>In my <a href="/posts/getting-started-with-react-context/">previous post</a>, I explored using React context to manage application state. In this post, I want to take a quick look at using React Context Types, which can help simplify consuming context in class-based components.</p>
<blockquote>
<p>This post follows directly on from my <a href="/posts/getting-started-with-react-context/">previous post</a> on React context. If you haven’t already done so, I suggest reading that first. Full source code is also available in the <a href="https://github.com/aaronmarr/react-context-type-example">Git repository</a>.</p>
</blockquote>
<h2 id="what-are-react-context-types">What are React Context Types <a class="hidden" href="#what-are-react-context-types">#</a></h2>
<p>From the documentation:</p>
<blockquote>
<p>The contextType property on a class can be assigned a Context object created by  <a href="https://reactjs.org/docs/context.html#reactcreatecontext">React.createContext()</a> . This lets you consume the nearest current value of that Context type using this.context. You can reference this in any of the lifecycle methods including the render function.</p>
</blockquote>
<h2 id="using-context-types">Using context types <a class="hidden" href="#using-context-types">#</a></h2>
<p>In my previous post, we created a <code>Counter.js</code> which defines a simple <code>Counter</code> component. Inside the render method, we wrap the component in a <code>Consumer</code> component, and use the render props pattern to access data and methods defined in the context.</p>
<pre class="language-js"><code class="language-js"><span class="highlight-line"><span class="token keyword">import</span> React <span class="token keyword">from</span> ‘react’<span class="token punctuation">;</span></span><br><span class="highlight-line"><span class="token keyword">import</span> <span class="token punctuation">{</span> CounterConsumer <span class="token punctuation">}</span> <span class="token keyword">from</span> ‘<span class="token punctuation">.</span><span class="token operator">/</span>CounterContext’<span class="token punctuation">;</span></span><br><span class="highlight-line"></span><br><span class="highlight-line"><span class="token keyword">class</span> <span class="token class-name">Counter</span> <span class="token keyword">extends</span> <span class="token class-name">React<span class="token punctuation">.</span>Component</span> <span class="token punctuation">{</span></span><br><span class="highlight-line">  <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span><br><span class="highlight-line">    <span class="token keyword">return</span> <span class="token punctuation">(</span></span><br><span class="highlight-line">      <span class="token operator">&lt;</span>CounterConsumer<span class="token operator">></span></span><br><span class="highlight-line">	      <span class="token comment">// Render props pattern gives us access to context</span></span><br><span class="highlight-line">        <span class="token punctuation">{</span><span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> counter<span class="token punctuation">,</span> onIncrement<span class="token punctuation">,</span> onDecrement <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">(</span></span><br><span class="highlight-line">          <span class="token operator">&lt;</span>div className<span class="token operator">=</span>“counter”<span class="token operator">></span></span><br><span class="highlight-line">            <span class="token operator">&lt;</span>h1 className<span class="token operator">=</span>“counter__count”<span class="token operator">></span>Count<span class="token operator">:</span> <span class="token punctuation">{</span>counter<span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>h1<span class="token operator">></span></span><br><span class="highlight-line">            <span class="token operator">&lt;</span>button className<span class="token operator">=</span>“counter__inc” onClick<span class="token operator">=</span><span class="token punctuation">{</span>onIncrement<span class="token punctuation">}</span><span class="token operator">></span></span><br><span class="highlight-line">              <span class="token operator">+</span></span><br><span class="highlight-line">            <span class="token operator">&lt;</span><span class="token operator">/</span>button<span class="token operator">></span> </span><br><span class="highlight-line">            <span class="token operator">&lt;</span>button className<span class="token operator">=</span>“counter__dec” onClick<span class="token operator">=</span><span class="token punctuation">{</span>onDecrement<span class="token punctuation">}</span><span class="token operator">></span></span><br><span class="highlight-line">              <span class="token operator">-</span></span><br><span class="highlight-line">            <span class="token operator">&lt;</span><span class="token operator">/</span>button<span class="token operator">></span> </span><br><span class="highlight-line">          <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">></span></span><br><span class="highlight-line">        <span class="token punctuation">)</span><span class="token punctuation">}</span></span><br><span class="highlight-line">      <span class="token operator">&lt;</span><span class="token operator">/</span>CounterConsumer<span class="token operator">></span></span><br><span class="highlight-line">    <span class="token punctuation">)</span></span><br><span class="highlight-line">  <span class="token punctuation">}</span></span><br><span class="highlight-line"><span class="token punctuation">}</span><span class="token punctuation">;</span></span><br><span class="highlight-line"></span><br><span class="highlight-line"><span class="token keyword">export</span> <span class="token keyword">default</span> Counter<span class="token punctuation">;</span></span></code></pre>
<p>Since React 16.6, we can now improve on this implementation using context types. We can use the <code>contextType</code> static property, which is available on React classes, to associate our <code>CounterContext</code> with our class. Then, inside the render method (or any lifecycle method), we can access the context via <code>this.context</code>.</p>
<p>Let’s take a look at the updated <code>Counter</code> component.</p>
<pre class="language-js"><code class="language-js"><span class="highlight-line"><span class="token keyword">import</span> React <span class="token keyword">from</span> ‘react’<span class="token punctuation">;</span></span><br><span class="highlight-line"><span class="token comment">// Destructure the full context object from context</span></span><br><span class="highlight-line"><span class="token keyword">import</span> <span class="token punctuation">{</span> CounterContext <span class="token punctuation">}</span> <span class="token keyword">from</span> ‘<span class="token punctuation">.</span><span class="token operator">/</span>CounterContext’<span class="token punctuation">;</span></span><br><span class="highlight-line"></span><br><span class="highlight-line"><span class="token keyword">class</span> <span class="token class-name">Counter</span> <span class="token keyword">extends</span> <span class="token class-name">React<span class="token punctuation">.</span>Component</span> <span class="token punctuation">{</span></span><br><span class="highlight-line">  <span class="token comment">// Associate our context with the class</span></span><br><span class="highlight-line">  <span class="token keyword">static</span> contextType <span class="token operator">=</span> CounterContext<span class="token punctuation">;</span></span><br><span class="highlight-line"></span><br><span class="highlight-line">  <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span><br><span class="highlight-line">    <span class="token comment">// Now we can access context via this.context</span></span><br><span class="highlight-line">    <span class="token keyword">const</span> <span class="token punctuation">{</span> counter<span class="token punctuation">,</span> onIncrement<span class="token punctuation">,</span> onDecrement <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>context<span class="token punctuation">;</span></span><br><span class="highlight-line"></span><br><span class="highlight-line">    <span class="token keyword">return</span> <span class="token punctuation">(</span></span><br><span class="highlight-line">      <span class="token comment">// No need to wrap the return value in a context component</span></span><br><span class="highlight-line">      <span class="token comment">// or use render props pattern</span></span><br><span class="highlight-line">      <span class="token operator">&lt;</span>div className<span class="token operator">=</span>“counter”<span class="token operator">></span></span><br><span class="highlight-line">        <span class="token operator">&lt;</span>h1 className<span class="token operator">=</span>“counter__count”<span class="token operator">></span>Count<span class="token operator">:</span> <span class="token punctuation">{</span>counter<span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>h1<span class="token operator">></span></span><br><span class="highlight-line">        <span class="token operator">&lt;</span>button className<span class="token operator">=</span>“counter__inc” onClick<span class="token operator">=</span><span class="token punctuation">{</span>onIncrement<span class="token punctuation">}</span><span class="token operator">></span></span><br><span class="highlight-line">	        <span class="token operator">+</span></span><br><span class="highlight-line">        <span class="token operator">&lt;</span><span class="token operator">/</span>button<span class="token operator">></span> </span><br><span class="highlight-line">        <span class="token operator">&lt;</span>button className<span class="token operator">=</span>“counter__dec” onClick<span class="token operator">=</span><span class="token punctuation">{</span>onDecrement<span class="token punctuation">}</span><span class="token operator">></span></span><br><span class="highlight-line">          <span class="token operator">-</span></span><br><span class="highlight-line">        <span class="token operator">&lt;</span><span class="token operator">/</span>button<span class="token operator">></span> </span><br><span class="highlight-line">      <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">></span></span><br><span class="highlight-line">    <span class="token punctuation">)</span></span><br><span class="highlight-line">  <span class="token punctuation">}</span></span><br><span class="highlight-line"><span class="token punctuation">}</span><span class="token punctuation">;</span></span><br><span class="highlight-line"></span><br><span class="highlight-line"><span class="token keyword">export</span> <span class="token keyword">default</span> Counter<span class="token punctuation">;</span></span></code></pre>
<p>I think this is a much more elegant solution for class-based components – the context values are readily available in lifecycle methods (such as render) and there is much less nesting required in the render function.</p>
<p>I hope you’ve found this post useful. Thanks for reading.</p>

  </div>
</article>



    </main>
    <footer class="border-t block pt-4 pb-8 mt-16">
      <div class="max-w-xl m-auto px-4 flex items-baseline">
        <p class="font-sans text-xs">&copy Aaron Marr 2020.</p>
        <a href="#" class="[ site-header__button ] [ ml-auto p-2 border border-solid font-sans text-sm ]" onclick="localStorage.setItem('mode', (localStorage.getItem('mode') || 'dark') === 'dark' ? 'light' : 'dark'); localStorage.getItem('mode') === 'dark' ? document.querySelector('body').classList.add('dark') : document.querySelector('body').classList.remove('dark')" title="Dark/light">
          <span class="hidden-when-dark">Dark mode</span>
          <span class="hidden shown-when-dark">Light mode</span>
        </a>
      </div>
    </footer>
    <script>
        document.addEventListener('DOMContentLoaded', function(event) {
        event.preventDefault();
        ((localStorage.getItem('mode') || 'dark') === 'dark') ?
          document.querySelector('body').classList.add('dark') :
          document.querySelector('body').classList.remove('dark');
      })
    </script>
  </body>
</html>
